# 데이터 업로드 가이드

## CSV/TXT 파일 업로드 기능 사용법

### 1. 데이터 임포트 페이지 접속

브라우저에서 다음 주소로 접속하세요:
- 개발 환경: http://localhost:3001/import
- 또는 홈페이지에서 "데이터 임포트" 카드 클릭

### 2. 파일 업로드

두 가지 방법으로 파일을 업로드할 수 있습니다:

**방법 1: 드래그 앤 드롭**
- CSV 또는 TXT 파일을 업로드 영역으로 드래그하여 놓으세요

**방법 2: 파일 선택**
- 업로드 영역을 클릭하여 파일 선택 대화상자를 열고 파일을 선택하세요

### 3. 파일 형식 요구사항

**지원 파일 형식**:
- `.csv` (Comma-Separated Values)
- `.txt` (Tab 또는 Comma 구분)

**파일 구조**:
```csv
S,등록일시,PID,공정,품목코드,품명,가로,세로,수량,평수,의뢰번호,NO.,거래처,현장,라인,등록자,비고,일자,시간,연,월,주차,면적
FALSE,2025-01-02 8:36,JCQ00441,포장공정,P01626,5CL+12단열+5로이,743,1780,1,14.4,24-2621,31,현대엔지니어링㈜t,아산모종 2지구 공동주택 신축공사,2-LINE,복층2,"3동2라인84B형19-22층,거실內小",2025-01-02,오전 8:36:54,2025,1,53,1.32
```

**필수 헤더** (첫 번째 행):
- S, 등록일시, PID, 공정, 품목코드, 품명, 가로, 세로, 수량, 평수, 의뢰번호, NO., 거래처, 현장, 라인, 등록자, 비고, 일자, 시간, 연, 월, 주차, 면적

### 4. 데이터 검증

시스템은 자동으로 다음 항목을 검증합니다:

**필수 필드**:
- ✅ 일자 (생산일자)
- ✅ 품명

**데이터 유효성**:
- ✅ 수량 ≥ 0
- ✅ 평수 ≥ 0
- ✅ 날짜 형식 (YYYY-MM-DD)
- ✅ 숫자 형식

검증 실패 시:
- 해당 행은 건너뛰고 계속 진행
- 오류 메시지가 결과 화면에 표시됨

### 5. 업로드 프로세스

1. **파싱** (10%)
   - CSV 파일을 읽고 데이터 구조로 변환

2. **검증** (20%)
   - 각 레코드의 유효성 검사
   - 잘못된 데이터 필터링

3. **배치 삽입** (20% ~ 90%)
   - 1000개씩 배치로 나누어 Supabase에 저장
   - 대용량 파일도 안정적으로 처리

4. **완료** (100%)
   - 결과 요약 표시
   - 성공/실패 건수 확인

### 6. 업로드 결과 확인

업로드 완료 후 다음 정보를 확인할 수 있습니다:

**통계**:
- 총 레코드 수
- 성공한 레코드 수 (녹색)
- 실패한 레코드 수 (빨간색)

**오류 목록**:
- 실패한 행 번호와 오류 메시지
- 최대 10개까지 표시

### 7. 주의사항

**파일 크기**:
- 최대 100MB까지 지원
- 대용량 파일은 업로드에 시간이 걸릴 수 있습니다

**중복 데이터**:
- 시스템은 자동으로 중복을 체크하지 않습니다
- 같은 파일을 여러 번 업로드하면 중복 레코드가 생성됩니다

**인코딩**:
- UTF-8 인코딩을 사용하세요
- Excel에서 저장 시 "CSV UTF-8" 형식을 선택하세요

**네트워크**:
- 안정적인 인터넷 연결이 필요합니다
- 업로드 중 페이지를 닫지 마세요

### 8. 문제 해결

**업로드가 시작되지 않는 경우**:
1. Supabase 설정 확인 (`.env.local`)
2. 브라우저 콘솔에서 오류 메시지 확인
3. 파일 형식이 올바른지 확인

**일부 데이터만 업로드된 경우**:
1. 오류 목록 확인
2. 원본 파일의 해당 행 수정
3. 다시 업로드

**"RLS 정책 위반" 오류**:
1. Supabase에 로그인되어 있는지 확인
2. 데이터베이스 RLS 정책 확인

## 예제 파일

프로젝트 루트의 `2026 생산실적 비고포함3.txt` 파일을 참고하세요.

## 다음 단계

업로드 완료 후:
1. **대시보드**에서 전체 현황 확인
2. **데이터 그리드**에서 상세 데이터 조회
3. 필터와 정렬로 원하는 정보 찾기

---

**문의사항이 있으시면 시스템 관리자에게 문의하세요.**
