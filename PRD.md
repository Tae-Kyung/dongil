# PRD: 동일유리 생산실적 다차원 분석 시스템

## 1. 프로젝트 개요

### 1.1 프로젝트 명
동일유리 생산실적 다차원 분석 및 의사결정 지원 시스템

### 1.2 프로젝트 목적
동일유리의 생산실적 데이터를 기반으로 다차원 분석을 통해 다양한 관점에서 실적 정보를 신속하게 파악하고, 데이터 기반 의사결정을 지원하는 웹 기반 분석 플랫폼 구축

### 1.3 프로젝트 범위
- 생산실적 데이터 시각화 및 다차원 분석
- 동적 필터링 및 드릴다운 기능
- 대시보드 및 리포트 생성
- 데이터베이스 기반 데이터 관리 (Supabase)
- 반응형 웹 인터페이스

---

## 2. 배경 및 목표

### 2.1 현재 상황
- 현재 Excel 기반 보고서(report1.png, report2.png)를 사용 중
- 생산실적 데이터(CSV/TXT 형식, 약 49MB)를 수동으로 관리
- 제한적인 데이터 분석 및 시각화 기능
- 실시간 현황 파악의 어려움

### 2.2 문제점
- 대용량 데이터 처리 시 성능 저하
- 다차원 분석의 제한성
- 데이터 집계 및 리포트 생성에 많은 시간 소요
- 의사결정을 위한 통찰력 있는 정보 도출 어려움
- 데이터 공유 및 협업의 어려움

### 2.3 프로젝트 목표
1. **신속한 현황 파악**: 실시간에 가까운 생산실적 조회 및 분석
2. **다차원 분석**: 다양한 차원(시간, 거래처, 품목, 현장 등)에서의 데이터 분석
3. **의사결정 지원**: 데이터 기반 인사이트 제공
4. **효율성 향상**: 보고서 생성 자동화 및 시간 절감
5. **확장성**: 향후 추가 기능 및 데이터 소스 통합 가능

---

## 3. 사용자 페르소나

### 3.1 주요 사용자
- **경영진**: 전체 생산 현황 및 트렌드 파악, 의사결정 지원
- **생산관리자**: 일일/주간/월간 생산실적 모니터링, 이슈 파악
- **영업/마케팅**: 거래처별 실적 분석, 현장별 진행 상황 확인
- **데이터 관리자**: 데이터 입력, 수정, 관리

---

## 4. 핵심 기능 요구사항

### 4.1 데이터 분석 및 시각화

#### 4.1.1 다차원 분석 (OLAP 스타일)
- **시간 차원**: 연도, 월, 주차, 일자, 시간대별 분석
- **거래처 차원**: 거래처별 생산실적 집계
- **품목 차원**: 품명, 품목코드별 분석
- **현장 차원**: 현장별 생산 현황
- **공정 차원**: 공정별 실적 분석
- **라인 차원**: 생산 라인별 분석

#### 4.1.2 핵심 지표 (KPI)
- 총 생산 수량
- 총 생산 평수
- 거래처별/품목별/현장별 수량 및 평수
- 일일/주간/월간 생산량 추이
- 평균 생산 면적
- 공정별 처리량

#### 4.1.3 시각화 컴포넌트
- **대시보드**
  - 주요 KPI 카드
  - 생산량 추이 그래프 (라인/바 차트)
  - 거래처별 비중 (파이/도넛 차트)
  - 품목별 분포 (트리맵/바 차트)
  - 히트맵 (시간대별/요일별 생산량)

- **상세 분석 뷰**
  - 피벗 테이블 (드래그 앤 드롭 차원 설정)
  - 계층적 트리 뷰 (드릴다운/롤업)
  - 상세 데이터 그리드 (정렬, 필터링, 검색)

#### 4.1.4 필터링 및 검색
- 다중 차원 필터 (체크박스, 드롭다운)
- 날짜 범위 선택기
- 텍스트 기반 검색 (의뢰번호, 거래처, 현장 등)
- 저장된 필터 프리셋

### 4.2 데이터 관리

#### 4.2.1 데이터 입력/수정
- CSV/TXT 파일 업로드 및 파싱
- 배치 데이터 임포트
- 개별 레코드 수정/삭제
- 데이터 검증 및 오류 처리

#### 4.2.2 데이터베이스 관리 (Supabase)
- PostgreSQL 기반 데이터 저장
- 인덱싱 및 쿼리 최적화
- 데이터 백업 및 복원
- 변경 이력 추적 (옵션)

### 4.3 리포트 생성

#### 4.3.1 자동 리포트
- 일일/주간/월간 정기 리포트
- 사용자 정의 리포트 템플릿
- PDF/Excel 내보내기

#### 4.3.2 리포트 공유
- 링크 기반 리포트 공유
- 이메일 자동 발송 (옵션)

### 4.4 사용자 관리 및 권한

#### 4.4.1 인증 및 권한
- 사용자 로그인/로그아웃 (Supabase Auth)
- 역할 기반 접근 제어 (RBAC)
  - 관리자: 모든 기능 접근
  - 일반 사용자: 조회 및 분석만 가능
  - 데이터 관리자: 데이터 입력/수정 권한

---

## 5. 데이터 모델

### 5.1 생산실적 테이블 (production_records)

```sql
CREATE TABLE production_records (
  id BIGSERIAL PRIMARY KEY,
  s BOOLEAN,
  registered_at TIMESTAMP,
  pid VARCHAR(50),
  process VARCHAR(100),
  product_code VARCHAR(50),
  product_name VARCHAR(255),
  width DECIMAL(10,2),
  height DECIMAL(10,2),
  quantity INTEGER,
  area_pyeong DECIMAL(10,2),
  order_number VARCHAR(50),
  order_no VARCHAR(10),
  client VARCHAR(255),
  site VARCHAR(255),
  line VARCHAR(50),
  registrar VARCHAR(100),
  note TEXT,
  production_date DATE,
  production_time TIME,
  year INTEGER,
  month INTEGER,
  week INTEGER,
  area_sqm DECIMAL(10,2),
  created_at TIMESTAMP DEFAULT NOW(),
  updated_at TIMESTAMP DEFAULT NOW()
);
```

### 5.2 인덱스 전략
```sql
-- 성능 최적화를 위한 인덱스
CREATE INDEX idx_production_date ON production_records(production_date);
CREATE INDEX idx_client ON production_records(client);
CREATE INDEX idx_order_number ON production_records(order_number);
CREATE INDEX idx_product_name ON production_records(product_name);
CREATE INDEX idx_site ON production_records(site);
CREATE INDEX idx_year_month ON production_records(year, month);
CREATE INDEX idx_year_week ON production_records(year, week);
```

### 5.3 추가 테이블 (확장성 고려)

#### 5.3.1 거래처 마스터 (clients)
```sql
CREATE TABLE clients (
  id BIGSERIAL PRIMARY KEY,
  name VARCHAR(255) UNIQUE NOT NULL,
  code VARCHAR(50),
  contact VARCHAR(100),
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### 5.3.2 품목 마스터 (products)
```sql
CREATE TABLE products (
  id BIGSERIAL PRIMARY KEY,
  code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(255) NOT NULL,
  category VARCHAR(100),
  created_at TIMESTAMP DEFAULT NOW()
);
```

#### 5.3.3 사용자 정의 리포트 (saved_reports)
```sql
CREATE TABLE saved_reports (
  id BIGSERIAL PRIMARY KEY,
  user_id UUID REFERENCES auth.users(id),
  name VARCHAR(255) NOT NULL,
  description TEXT,
  config JSONB,
  created_at TIMESTAMP DEFAULT NOW()
);
```

---

## 6. 기술 스택

### 6.1 프론트엔드
- **프레임워크**: React 18+ (또는 Next.js 14+)
- **UI 라이브러리**:
  - Tailwind CSS (스타일링)
  - shadcn/ui 또는 Material-UI (컴포넌트)
- **차트 라이브러리**:
  - Recharts 또는 Apache ECharts (기본 차트)
  - AG Grid 또는 TanStack Table (데이터 그리드)
  - PivotTable.js 또는 직접 구현 (피벗 테이블)
- **상태 관리**:
  - React Query (서버 상태)
  - Zustand 또는 Redux Toolkit (클라이언트 상태)
- **날짜 처리**: date-fns 또는 Day.js

### 6.2 백엔드
- **BaaS**: Supabase
  - PostgreSQL (데이터베이스)
  - Authentication (인증)
  - Row Level Security (권한 관리)
  - Realtime (실시간 업데이트, 옵션)
  - Storage (파일 업로드, 옵션)

### 6.3 개발 도구
- **언어**: TypeScript
- **패키지 매니저**: pnpm 또는 npm
- **빌드 도구**: Vite 또는 Next.js
- **코드 품질**: ESLint, Prettier
- **버전 관리**: Git

### 6.4 배포
- **호스팅**: Vercel, Netlify, 또는 Cloudflare Pages
- **CI/CD**: GitHub Actions

---

## 7. 시스템 아키텍처

### 7.1 시스템 구성도

```
┌─────────────────────────────────────────────────────┐
│                   클라이언트 브라우저                     │
│  ┌──────────────────────────────────────────────┐   │
│  │          React/Next.js 애플리케이션             │   │
│  │  ┌──────────┐  ┌──────────┐  ┌──────────┐   │   │
│  │  │대시보드    │  │분석 뷰    │  │데이터 관리 │   │   │
│  │  └──────────┘  └──────────┘  └──────────┘   │   │
│  │                                               │   │
│  │  ┌──────────────────────────────────────┐   │   │
│  │  │      상태 관리 (React Query, Zustand)  │   │   │
│  │  └──────────────────────────────────────┘   │   │
│  └──────────────────────────────────────────────┘   │
└────────────────────┬────────────────────────────────┘
                     │ HTTPS/REST API
                     ↓
┌─────────────────────────────────────────────────────┐
│                  Supabase Platform                   │
│  ┌──────────────────────────────────────────────┐   │
│  │            PostgreSQL Database                │   │
│  │  • production_records                         │   │
│  │  • clients, products (마스터)                 │   │
│  │  • saved_reports                              │   │
│  └──────────────────────────────────────────────┘   │
│                                                      │
│  ┌──────────────────────────────────────────────┐   │
│  │          Authentication & Authorization       │   │
│  │  • Row Level Security (RLS)                   │   │
│  └──────────────────────────────────────────────┘   │
│                                                      │
│  ┌──────────────────────────────────────────────┐   │
│  │              Storage (옵션)                    │   │
│  │  • CSV/TXT 파일 업로드                         │   │
│  └──────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────┘
```

### 7.2 데이터 흐름

1. **데이터 임포트**
   - 사용자가 CSV/TXT 파일 업로드
   - 프론트엔드에서 파일 파싱 및 검증
   - Supabase API를 통해 데이터 저장

2. **데이터 조회 및 분석**
   - 사용자가 필터 및 차원 선택
   - React Query를 통해 Supabase에 쿼리
   - 결과 데이터를 캐싱 및 시각화

3. **실시간 업데이트 (옵션)**
   - Supabase Realtime 구독
   - 데이터 변경 시 자동 갱신

---

## 8. UI/UX 요구사항

### 8.1 레이아웃 구조

#### 8.1.1 메인 네비게이션
- **대시보드**: 주요 KPI 및 요약 정보
- **분석**: 다차원 분석 및 상세 뷰
- **데이터 관리**: 데이터 임포트/수정
- **리포트**: 리포트 생성 및 관리
- **설정**: 사용자 설정 및 권한 관리

#### 8.1.2 대시보드 화면
```
┌─────────────────────────────────────────────────┐
│  [로고]  대시보드   분석   데이터관리   리포트   [사용자] │
├─────────────────────────────────────────────────┤
│  [날짜 범위: 2026-01-01 ~ 2026-01-31] [필터 ▼]  │
├──────────┬──────────┬──────────┬───────────────┤
│  총 수량  │  총 평수  │ 거래처 수 │  금일 생산량  │
│  14,412  │ 144,133  │    25    │    938       │
├──────────┴──────────┴──────────┴───────────────┤
│                                                  │
│  ┌────────────────────────────────────────┐    │
│  │   생산량 추이 (라인 차트)                 │    │
│  │                                         │    │
│  └────────────────────────────────────────┘    │
│                                                  │
│  ┌────────────────┐  ┌────────────────────┐    │
│  │거래처별 비중    │  │품목별 생산량        │    │
│  │(도넛 차트)      │  │(바 차트)           │    │
│  └────────────────┘  └────────────────────┘    │
└──────────────────────────────────────────────────┘
```

#### 8.1.3 분석 화면
- **좌측 패널**: 차원 및 필터 선택
  - 드래그 앤 드롭으로 행/열 차원 설정
  - 체크박스/드롭다운 필터
- **중앙 영역**: 피벗 테이블 또는 차트
- **우측 패널**: 상세 정보 및 설정

### 8.2 반응형 디자인
- **데스크톱** (≥1280px): 전체 기능 제공
- **태블릿** (768px ~ 1279px): 축소된 레이아웃
- **모바일** (≤767px): 핵심 기능 중심, 간소화된 UI

### 8.3 UX 원칙
- **직관성**: 최소한의 학습 곡선
- **성능**: 1초 이내 초기 로딩, 빠른 필터링/정렬
- **접근성**: WCAG 2.1 AA 준수
- **일관성**: 통일된 디자인 시스템

---

## 9. 비기능 요구사항

### 9.1 성능
- **초기 로딩**: 3초 이내
- **데이터 조회**: 1초 이내 (10만 건 기준)
- **필터링/정렬**: 500ms 이내
- **차트 렌더링**: 1초 이내

### 9.2 확장성
- **데이터 볼륨**: 100만 건 이상 지원
- **동시 사용자**: 50명 이상

### 9.3 보안
- **인증**: Supabase Auth (이메일/비밀번호, OAuth)
- **권한**: Row Level Security (RLS)
- **데이터 전송**: HTTPS 암호화
- **SQL Injection 방지**: 파라미터화된 쿼리

### 9.4 안정성
- **가용성**: 99% 이상
- **데이터 백업**: 일일 자동 백업
- **오류 처리**: 에러 바운더리 및 사용자 친화적 메시지

### 9.5 유지보수성
- **코드 품질**: TypeScript, ESLint, Prettier
- **문서화**: 코드 주석, README, API 문서
- **테스트**: 단위 테스트 커버리지 70% 이상 (목표)

---

## 10. 개발 로드맵

### Phase 1: MVP (4-6주)
- [x] 요구사항 정의 및 PRD 작성
- [ ] 프로젝트 설정 및 Supabase 초기화
- [ ] 데이터 모델 설계 및 테이블 생성
- [ ] CSV/TXT 파일 업로드 및 파싱 기능
- [ ] 기본 대시보드 (주요 KPI, 간단한 차트)
- [ ] 데이터 그리드 (정렬, 필터링)
- [ ] 사용자 인증 (로그인/로그아웃)
- [ ] 배포 (Vercel/Netlify)

### Phase 2: 고도화 (4-6주)
- [ ] 다차원 분석 기능 (피벗 테이블)
- [ ] 고급 차트 (라인, 바, 파이, 히트맵)
- [ ] 동적 필터 및 검색
- [ ] 드릴다운/롤업 기능
- [ ] 리포트 생성 (PDF/Excel 내보내기)
- [ ] 성능 최적화 (쿼리 최적화, 캐싱)

### Phase 3: 확장 (3-4주)
- [ ] 실시간 업데이트 (Supabase Realtime)
- [ ] 사용자 정의 리포트 템플릿
- [ ] 역할 기반 권한 관리 (RBAC)
- [ ] 데이터 변경 이력 추적
- [ ] 이메일 알림 및 자동 리포트 발송
- [ ] 모바일 최적화

---

## 11. 성공 지표 (KPI)

### 11.1 비즈니스 지표
- **리포트 생성 시간 단축**: 기존 대비 70% 감소
- **데이터 접근성**: 일일 활성 사용자 수 10명 이상
- **사용자 만족도**: 설문 조사 점수 4.0/5.0 이상

### 11.2 기술 지표
- **페이지 로딩 속도**: 평균 2초 이내
- **시스템 가동률**: 99% 이상
- **에러율**: 1% 미만

---

## 12. 리스크 및 제약사항

### 12.1 리스크
1. **대용량 데이터 처리 성능**
   - 완화 전략: 인덱싱, 쿼리 최적화, 페이지네이션, 캐싱

2. **Supabase 제한 사항**
   - 완화 전략: 적절한 요금제 선택, 쿼리 최적화

3. **복잡한 피벗 테이블 구현**
   - 완화 전략: 기존 라이브러리 활용 또는 단계적 구현

4. **사용자 교육 필요**
   - 완화 전략: 직관적 UI 설계, 가이드 문서 제공

### 12.2 제약사항
1. **예산**: Supabase 무료 티어 제한 (스토리지, API 요청 수)
2. **개발 리소스**: 개발자 1-2명, 파트타임 가능
3. **일정**: 3-4개월 내 Phase 2 완료 목표

### 12.3 가정
- 현재 데이터 형식(CSV/TXT)이 일관성 있게 유지됨
- 사용자 수는 점진적으로 증가 (초기 10-20명)
- 인터넷 연결 환경에서 사용

---

## 13. 부록

### 13.1 참고 자료
- 현재 보고서: report1.png, report2.png
- 생산실적 데이터: 2026 생산실적 비고포함3.txt

### 13.2 용어 정의
- **평수**: 한국 전통 면적 단위 (1평 = 3.3058㎡)
- **의뢰번호**: 생산 주문 식별자
- **NO.**: 의뢰번호 내 개별 항목 번호
- **거래처**: 제품을 주문한 고객사
- **현장**: 제품이 납품될 건설 현장

### 13.3 향후 검토 항목
- AI 기반 수요 예측 및 이상 탐지
- 모바일 앱 (React Native)
- 다국어 지원
- 외부 ERP 시스템 연동
- 공급망 관리 기능 통합

---

**문서 작성일**: 2026-01-28
**작성자**: Claude (AI Assistant)
**버전**: 1.0
**상태**: 초안 (Draft)
